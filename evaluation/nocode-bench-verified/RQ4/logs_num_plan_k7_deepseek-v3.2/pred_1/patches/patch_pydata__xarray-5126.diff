diff --git a/xarray/core/formatting.py b/xarray/core/formatting.py
index 48cd89e..565c693 100644
--- a/xarray/core/formatting.py
+++ b/xarray/core/formatting.py
@@ -1,3 +1,4 @@
+
 """String formatting routines for __repr__.
 """
 import contextlib
@@ -372,6 +373,30 @@ def _calculate_col_width(col_items):
 
 
 def _mapping_repr(mapping, title, summarizer, col_width=None, max_rows=None):
+    # Map title to option name for expand/collapse
+    title_to_option = {
+        "Attributes": "display_expand_attrs",
+        "Coordinates": "display_expand_coords",
+        "Data variables": "display_expand_data_vars",
+    }
+    option_name = title_to_option.get(title)
+    if option_name is not None:
+        expand = OPTIONS.get(option_name, "default")
+    else:
+        expand = "default"
+
+    if expand is True:
+        # Always expand: set max_rows to a large number
+        if max_rows is None:
+            max_rows = 10**6
+    elif expand is False:
+        # Collapse: show only the title and a placeholder
+        if col_width is None:
+            col_width = _calculate_col_width(mapping)
+        summary = [f"{title}: ..."]
+        return "\n".join(summary)
+    # else: default, use the existing logic
+
     if col_width is None:
         col_width = _calculate_col_width(mapping)
     if max_rows is None:
