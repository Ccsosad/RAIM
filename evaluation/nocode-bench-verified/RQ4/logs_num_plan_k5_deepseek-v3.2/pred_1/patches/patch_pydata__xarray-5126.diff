diff --git a/xarray/core/formatting.py b/xarray/core/formatting.py
index 48cd89e..66ed7c4 100644
--- a/xarray/core/formatting.py
+++ b/xarray/core/formatting.py
@@ -395,21 +395,44 @@ def _mapping_repr(mapping, title, summarizer, col_width=None, max_rows=None):
     return "\n".join(summary)
 
 
-data_vars_repr = functools.partial(
-    _mapping_repr, title="Data variables", summarizer=summarize_datavar
-)
+def data_vars_repr(data_vars, col_width=None):
+    if col_width is None:
+        col_width = _calculate_col_width(data_vars)
+    expand_opt = OPTIONS.get("display_expand_data_vars", "default")
+    if expand_opt is True:
+        max_rows = len(data_vars) if data_vars else 0
+    elif expand_opt is False:
+        max_rows = 0
+    else:  # default
+        max_rows = OPTIONS["display_max_rows"]
+    return _mapping_repr(data_vars, title="Data variables", summarizer=summarize_datavar, col_width=col_width, max_rows=max_rows)
 
 
-attrs_repr = functools.partial(
-    _mapping_repr, title="Attributes", summarizer=summarize_attr
-)
+def attrs_repr(attrs, col_width=None):
+    if col_width is None:
+        col_width = _calculate_col_width(attrs)
+    expand_opt = OPTIONS.get("display_expand_attrs", "default")
+    if expand_opt is True:
+        max_rows = len(attrs) if attrs else 0
+    elif expand_opt is False:
+        max_rows = 0
+    else:  # default
+        max_rows = OPTIONS["display_max_rows"]
+    return _mapping_repr(attrs, title="Attributes", summarizer=summarize_attr, col_width=col_width, max_rows=max_rows)
 
 
 def coords_repr(coords, col_width=None):
     if col_width is None:
         col_width = _calculate_col_width(_get_col_items(coords))
+    expand_opt = OPTIONS.get("display_expand_coords", "default")
+    if expand_opt is True:
+        max_rows = len(coords) if coords else 0
+    elif expand_opt is False:
+        max_rows = 0
+    else:  # default
+        max_rows = OPTIONS["display_max_rows"]
     return _mapping_repr(
-        coords, title="Coordinates", summarizer=summarize_coord, col_width=col_width
+        coords, title="Coordinates", summarizer=summarize_coord, col_width=col_width, max_rows=max_rows
     )
 
 
