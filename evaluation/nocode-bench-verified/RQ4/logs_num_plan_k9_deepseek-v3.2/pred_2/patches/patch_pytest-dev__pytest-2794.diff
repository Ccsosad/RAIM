diff --git a/_pytest/logging.py b/_pytest/logging.py
new file mode 100644
index 0000000..35abd94
--- /dev/null
+++ b/_pytest/logging.py
@@ -0,0 +1,308 @@
+# -*- coding: utf-8 -*-
+"""Logging plugin for pytest."""
+import logging
+import sys
+from contextlib import contextmanager
+
+import py
+import pytest
+
+from _pytest.config import create_terminal_writer
+from _pytest.terminal import TerminalReporter
+
+
+class LogCaptureHandler(logging.StreamHandler):
+    """A logging handler that stores log records and the log text."""
+
+    def __init__(self):
+        """Initialize the handler."""
+        logging.StreamHandler.__init__(self)
+        self.records = []
+        self.stream = py.io.TextIO()
+
+    def emit(self, record):
+        """Emit a record."""
+        self.records.append(record)
+        logging.StreamHandler.emit(self, record)
+
+    def reset(self):
+        """Reset the handler."""
+        self.records = []
+        self.stream = py.io.TextIO()
+
+
+class LogCaptureFixture(object):
+    """Fixture to capture log messages."""
+
+    def __init__(self, item):
+        """Initialize the fixture."""
+        self._item = item
+        self._handler = None
+        self._initial_log_levels = {}  # type: dict
+
+    @property
+    def handler(self):
+        """Get the handler."""
+        return self._handler
+
+    @handler.setter
+    def handler(self, handler):
+        """Set the handler."""
+        self._handler = handler
+
+    def get_records(self, when):
+        """Get the captured records for a phase."""
+        return self._item.catch_log_handlers[when].records
+
+    @property
+    def records(self):
+        """Get the captured records for the current phase."""
+        return self.get_records("call")
+
+    @property
+    def record_tuples(self):
+        """Get the captured records as tuples of (logger_name, level, message)."""
+        return [(r.name, r.levelno, r.getMessage()) for r in self.records]
+
+    @property
+    def text(self):
+        """Get the captured log text."""
+        return self._item.catch_log_handlers["call"].stream.getvalue()
+
+    def set_level(self, level, logger=None):
+        """Set the log level of a logger or the handler."""
+        if logger is None:
+            self.handler.setLevel(level)
+        else:
+            logger_obj = logging.getLogger(logger)
+            self._initial_log_levels.setdefault(logger, logger_obj.level)
+            logger_obj.setLevel(level)
+
+    @contextmanager
+    def at_level(self, level, logger=None):
+        """Context manager to set the log level temporarily."""
+        if logger is None:
+            old_level = self.handler.level
+            self.handler.setLevel(level)
+            try:
+                yield
+            finally:
+                self.handler.setLevel(old_level)
+        else:
+            logger_obj = logging.getLogger(logger)
+            old_level = logger_obj.level
+            logger_obj.setLevel(level)
+            try:
+                yield
+            finally:
+                logger_obj.setLevel(old_level)
+
+    def clear(self):
+        """Clear the captured records and output."""
+        self._item.catch_log_handlers["call"].reset()
+
+
+@pytest.fixture
+def caplog(request):
+    """Fixture to capture log messages."""
+    # Get the fixture from the item
+    if not hasattr(request.node, 'catch_log_handlers'):
+        # This should have been set by the logging plugin
+        return None
+    fixture = LogCaptureFixture(request.node)
+    fixture.handler = request.node.catch_log_handlers["call"]
+    return fixture
+
+
+class LoggingPlugin(object):
+    """Logging plugin for pytest."""
+
+    def __init__(self, config):
+        """Initialize the plugin."""
+        self.config = config
+        self.log_level = getattr(config.option, 'log_cli_level', None)
+        self.log_format = config.getini('log_format')
+        self.log_date_format = config.getini('log_date_format')
+        self.log_file = getattr(config.option, 'log_file', None)
+        self.log_file_level = getattr(config.option, 'log_file_level', None)
+        self.log_file_format = config.getini('log_file_format')
+        self.log_file_date_format = config.getini('log_file_date_format')
+        self.print_logs = config.getini('log_print')
+        self.capture_handler = None
+
+    def pytest_sessionstart(self, session):
+        """Start the logging capture."""
+        # Set up the capture handler for the session
+        if self.print_logs:
+            self.capture_handler = LogCaptureHandler()
+            self.capture_handler.setLevel(logging.NOTSET)
+            # Add the handler to the root logger
+            logging.getLogger().addHandler(self.capture_handler)
+
+    def pytest_runtest_setup(self, item):
+        """Set up the log capture for a test item."""
+        self._setup_capture(item, "setup")
+
+    def pytest_runtest_call(self, item):
+        """Set up the log capture for the test call phase."""
+        self._setup_capture(item, "call")
+
+    def pytest_runtest_teardown(self, item):
+        """Set up the log capture for the teardown phase."""
+        self._setup_capture(item, "teardown")
+
+    def _setup_capture(self, item, when):
+        """Set up the log capture for a given phase."""
+        if not hasattr(item, 'catch_log_handlers'):
+            item.catch_log_handlers = {}
+        handler = LogCaptureHandler()
+        item.catch_log_handlers[when] = handler
+        # Attach the handler to the root logger
+        logging.getLogger().addHandler(handler)
+
+    def pytest_runtest_makereport(self, item, call):
+        """Process the captured logs for reporting."""
+        when = call.when
+        if hasattr(item, 'catch_log_handlers') and when in item.catch_log_handlers:
+            handler = item.catch_log_handlers[when]
+            # Remove the handler from the root logger
+            logging.getLogger().removeHandler(handler)
+            # Store the records on the item for the fixture
+            if when == "call":
+                item.catch_log_records = handler.records
+                item.catch_log_output = handler.stream.getvalue()
+
+    def pytest_report_teststatus(self, report):
+        """Add the captured logs to the report."""
+        if report.failed and self.print_logs:
+            if hasattr(report, 'caplog'):
+                # Add the captured log to the report
+                report.sections.append(("Captured stdlog call", report.caplog))
+
+    def pytest_addoption(self, parser):
+        """Add command line options for logging."""
+        group = parser.getgroup("logging")
+        group.addoption(
+            "--log-level",
+            dest="log_level",
+            default=None,
+            help="Set the log level for the root logger."
+        )
+        group.addoption(
+            "--log-format",
+            dest="log_format",
+            default="%(levelname)-8s %(name)s %(message)s",
+            help="Set the log format."
+        )
+        group.addoption(
+            "--log-date-format",
+            dest="log_date_format",
+            default=None,
+            help="Set the log date format."
+        )
+        group.addoption(
+            "--log-cli-level",
+            dest="log_cli_level",
+            default=None,
+            help="Set the log level for the console."
+        )
+        group.addoption(
+            "--log-cli-format",
+            dest="log_cli_format",
+            default=None,
+            help="Set the log format for the console."
+        )
+        group.addoption(
+            "--log-cli-date-format",
+            dest="log_cli_date_format",
+            default=None,
+            help="Set the log date format for the console."
+        )
+        group.addoption(
+            "--log-file",
+            dest="log_file",
+            default=None,
+            help="Set the log file."
+        )
+        group.addoption(
+            "--log-file-level",
+            dest="log_file_level",
+            default=None,
+            help="Set the log level for the log file."
+        )
+        group.addoption(
+            "--log-file-format",
+            dest="log_file_format",
+            default=None,
+            help="Set the log format for the log file."
+        )
+        group.addoption(
+            "--log-file-date-format",
+            dest="log_file_date_format",
+            default=None,
+            help="Set the log date format for the log file."
+        )
+        group.addoption(
+            "--no-print-logs",
+            dest="log_print",
+            action="store_false",
+            default=True,
+            help="Disable printing logs on failed tests."
+        )
+
+    def pytest_configure(self, config):
+        """Configure the logging plugin."""
+        # Register the plugin
+        config.pluginmanager.register(self, "logging")
+        # Set up the logging configuration
+        self._configure_logging(config)
+
+    def _configure_logging(self, config):
+        """Configure the logging system."""
+        # Set up the root logger
+        root_logger = logging.getLogger()
+        root_logger.setLevel(logging.DEBUG)
+        # Remove existing handlers
+        for handler in root_logger.handlers[:]:
+            root_logger.removeHandler(handler)
+
+        # Add the capture handler if needed
+        if self.print_logs:
+            self.capture_handler = LogCaptureHandler()
+            self.capture_handler.setLevel(logging.NOTSET)
+            root_logger.addHandler(self.capture_handler)
+
+        # Set up the console handler if --log-cli-level is set
+        if self.log_level is not None:
+            console_handler = logging.StreamHandler(sys.stdout)
+            console_handler.setLevel(self.log_level)
+            formatter = logging.Formatter(self.log_format, self.log_date_format)
+            console_handler.setFormatter(formatter)
+            root_logger.addHandler(console_handler)
+
+        # Set up the file handler if --log-file is set
+        if self.log_file is not None:
+            file_handler = logging.FileHandler(self.log_file, mode='w')
+            file_handler.setLevel(self.log_file_level or logging.DEBUG)
+            formatter = logging.Formatter(self.log_file_format or self.log_format,
+                                          self.log_file_date_format or self.log_date_format)
+            file_handler.setFormatter(formatter)
+            root_logger.addHandler(file_handler)
+
+
+def pytest_addoption(parser):
+    """Add command line options for logging."""
+    # This is a hook that will be called by pytest
+    # We delegate to the LoggingPlugin's method
+    # But note: the plugin might not be registered yet.
+    # So we create a temporary plugin instance? Actually, we should not.
+    # Instead, we let the plugin register itself.
+    pass
+
+
+def pytest_configure(config):
+    """Configure the logging plugin."""
+    # This is a hook that will be called by pytest
+    # We create the plugin and register it.
+    plugin = LoggingPlugin(config)
+    config.pluginmanager.register(plugin, "logging")
